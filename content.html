<!--------------------------------
    Author: Mehmet Kahya
    Created: 17 March 2024
    Last Updated: 28 Aug 2024
-------------------------------->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Email Content</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="//cdn.repl.email/styles/water.css" />
    <link
        rel="stylesheet"
        href="https://use.fontawesome.com/releases/v5.13.0/css/all.css"
    />
    <link rel="icon" href="images/temp-mail-icon.png" type="image/x-icon" />
    <script src="api.js"></script>
</head>
<body>
    <header></header>
    <div class="contentContainer">
        <button onclick="window.history.back()">Back to Inbox</button>
        <div id="emailContent">
            <!-- Email content will be loaded here -->
        </div>
    </div>
    <footer>
        Andrey Franata - 2024 - TempMail -
        <a href="https://1secmail.com/" target="_blank" style="color: aliceblue;">1sec mail</a>
        <div class="social">
            <a href="mailto:mehmetkahyakas5@gmail.com" target="_blank">
                <i class="fas fa-envelope"></i>
            </a>
            <a href="https://github.com/mehmetkahya0" target="_blank">
                <i class="fab fa-github"></i>
            </a>
        </div>
    </footer>

    <script src="//code.jquery.com/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');
            const user = urlParams.get('user');
            const domain = urlParams.get('domain');

            if (id && user && domain) {
                $.getJSON(`https://www.1secmail.com/api/v1/?action=readMessage&login=${user}&domain=${domain}&id=${id}`, function(email) {
                    const contentElement = $('#emailContent');
                    contentElement.html(`
                        <div><strong>From:</strong> ${email.from}</div>
                        <div><strong>Date:</strong> ${email.date}</div>
                        <div><strong>Subject:</strong> ${email.subject}</div>
                        <div><strong>Content:</strong><br>${email.htmlBody ? email.htmlBody : email.body}</div>
                    `);

                    // Append attachments if any
                    if (email.attachments && email.attachments.length > 0) {
                        const attachments = $('<div><strong>Attachments:</strong><br></div>');
                        email.attachments.forEach(file => {
                            attachments.append(`<a href='https://www.1secmail.com/api/v1/?action=download&login=${user}&domain=${domain}&id=${id}&file=${file.filename}'>${file.filename}</a><br>`);
                        });
                        contentElement.append(attachments);
                    }
                });
            }
        });

        function warningAlert() {
            alert(
                "⚠️ This project is purely for educational purposes. We do not allow illegal things to be done with this project and we are not responsible for any incidents that may occur. This project uses 1secmail's API for creating e-mails. Use it legally ⚠️"
            );
        }
    </script>
</body>
</html>
